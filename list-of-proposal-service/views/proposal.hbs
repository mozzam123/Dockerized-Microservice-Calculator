<link rel="stylesheet" href="css/proposal.css">
<div class="container">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous" />
  <div class="username-section">
    <span class="username-label">Username:</span> {{currentUser}}
  </div>

  <table class="custom-table">
    <thead>
      <tr>
        <th scope="col">Sr No</th>
        <th scope="col">Username</th>
        <th scope="col">User ID</th>
        <th scope="col">Calculation ID</th>
        <th scope="col">Interest</th>
        <th scope="col">Principal Amount</th>
        <th scope="col">Total Amount</th>
        <th scope="col">Remarks</th>
        <th scope="col">Chart</th>
      </tr>
    </thead>
    <tbody>
      {{#each userData}}
      <tr>
        <th scope="row">{{@index}}</th>
        <td>{{username}}</td>
        <td>{{userId}}</td>
        <td>{{calculationId}}</td>
        <td>{{interest}}</td>
        <td>{{principalAmt}}</td>
        <td>{{totalAmt}}</td>
        <td>{{remarks}}</td>
        <td><button type="button" class="btn btn-primary" data-calculation-id="{{calculationId}}">Show Chart</button>
        </td>

      </tr>
      {{/each}}
    </tbody>
  </table>

  <div class="buttons-container">
    <form action="/proposal" method="post">
      <button type="submit" name="calculator">Calculator</button>
    </form>

    <form action="/" method="get">
      <button type="submit" name="login">Back to login</button>
    </form>
  </div>
</div>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const primaryButtons = document.querySelectorAll('.btn-primary');

    primaryButtons.forEach(button => {
      button.addEventListener('click', function () {
        const calculationId = this.getAttribute('data-calculation-id');
        console.log('********calculation id: ', calculationId)
        window.location.href = `http://127.0.0.1:2222/charts?calculationId=${calculationId}`;
      });
    });
  });
</script>